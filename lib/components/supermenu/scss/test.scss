@import "../../../node_modules/sass-ignis/src/main";
@import "../../../node_modules/sass-ignis/src/bem-shortcodes";

@function str-remove-whitespace($str) {
    @while (str-index($str, ' ') != null) {
        $index : str-index($str, ' ');
        $str : "#{str-slice($str, 0, $index - 1)}#{str-slice($str, $index + 1)}";
    }
    @return $str;
}


@mixin mul($first, $other...) {
    $mixin : str-remove-whitespace(str_slice($first, 0, str_index($first, ' ')));
    $name  : str-remove-whitespace(str_slice($first, str_index($first, ' ')));

    @warn '$mixin: "#{$mixin}". $name: "#{$name}". mixin exists: #{mixin_exists($mixin)}';
    @warn 'first: #{$first}. other: #{length($other)}';

    @each $arg in $other{
        //noinspection CssInvalidFunction
        $map : mul-arg($arg);
        $sign:nth($map, 1);
        $mixin2:nth($map, 2);
        $name:nth($map, 3);
        @debug '@each $sign: #{$sign} $mixin2: #{$mixin2} $name: #{$name} $map: #{inspect($map)}'
    }

    @include call_bem_mixin(unquote($mixin), $name) {
        @content;
    }
}


@mixin call_bem_mixin($mixin, $args...) {
    @debug 'call_bem_mixin #{unquote($mixin)}';
    @if $mixin == 'is' {
        @include is($args...) {@content}
    } @else if $mixin == 'has' {
        @include has($args...) {@content}
    } @else if $mixin == 'b' {
        @include b($args...) {@content}
    } @else if $mixin == 'e' {
        @include e($args...) {@content}
    } @else if $mixin == 'm' {
        @include m($args...) {@content}
    } @else {
        @error 'invalid mixin name "#{$mixin}"';
    }
}


@include mul('is hover', '> e content', '> e icon', '>') {


}

